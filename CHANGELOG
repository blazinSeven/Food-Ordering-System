This new one contains the working search-sort function (except sortByDistance)